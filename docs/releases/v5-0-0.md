# Google MailPilot v5.0.0 Release Notes

Google MailPilot v5.0.0 is the first public release under the new brand. It is built on the same safety-first foundations as the previous Gmail Secretary MCP work, but the focus for this release was on **code quality, reliability, and documentation clarity** rather than a dramatic feature expansion.

## Release Highlights

- **Tool registration stabilization**: `workspace_secretary.tools` now registers every FastMCP tool when the module loads, so MCP clients (Claude, OpenCode, etc.) never miss APIs due to lazy registration or delayed imports.
- **Continuation-state resilience**: Batch tools (`triage_priority_emails`, `quick_clean_inbox`, etc.) now accept `continuation_state` values prefixed with `raw:` so FastMCP doesn’t pre-parse JSON strings and fail validation. Callers can safely re-use the original payloads.
- **Postgres + pgvector-first backend**: Semantic search, booking links, and the shared MCP/web cache now require PostgreSQL with pgvector. Developers shipping quick tests can still use SQLite locally, but production deployments use Postgres for embeddings, booking metadata, and the consistent `booking_links` table.
- **Synced tests for triage and compose**: The tricky async tests under `tests/test_triage_priority_emails.py` and `tests/test_web_compose.py` now run synchronously via `asyncio.run(tools.mcp.call_tool(...))`, meaning the suite no longer depends on `pytest-asyncio` and matches the synchronous tools used in production.
- **Booking-link scheduler**: New helpers in `workspace_secretary/db/queries/booking_links.py` plus the web routes `/book/{link_id}`, `/api/calendar/booking-slots`, and `/api/calendar/book` let invitees reserve time without direct access to Google credentials.
- **Signal enrichment**: `workspace_secretary/email_auth.py` parses SPF/DKIM/DMARC headers so the phishing analyzer and UI can provide richer context during triage and compose.

## Code & Documentation Quality Workstream

1. **Comprehensive doc refresh**: Every file under `docs/` now reflects the MailPilot codebase—configuration defaults, Postgres requirements, booking workflows, tool references, and portal architecture—so the narrative aligns with the shipped code, not just the brand.
2. **Safety narrative**: Guides emphasize raw continuation states, `create_draft_reply` workflows, and human-in-the-loop guardrails, keeping readers focused on quality and trust rather than marketing buzz.
3. **Deployment guides**: Docker, configuration, and guide pages explain the three-process architecture, Postgres/pgvector setup, booking-link metadata, and recommended proxy/security layers.
4. **Release documentation**: This page and the updated README/CHANGELOG highlight the release-level improvements so users understand what changed in v5.0.0 beyond the rebranding.

## Next Steps for the Roadmap

- Polish the booking UI/UX (`calendar_booking.html`, `calendar_find_time.html`) to add multi-day availability and stronger branding copy.
- Surface booking + calendar telemetry in the portal (logs, metrics) so operators can monitor flow success rates and slot usage.
- Continue expanding documentation coverage (tools, guides, embeddings) to keep every narrative path aligned with the codebase.

---

**Need help deploying or building agents on MailPilot?** See the [Getting Started](../getting-started.md) guide or open an issue: https://github.com/johnneerdael/google-mailpilot/issues
